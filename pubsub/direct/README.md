# 订阅/发布 （direct）直接实现

> 生产者

- 声明交换机（持久化） kind=direct
- 不需要声明队列（不需要指定key）
- 消息直接发送到交换机的路由键上，Publish需要设置键名

> 消费者

- 声明交换机（持久化）kind=direct 同生产者一直
- 队列声明

    - 不需要名称（服务器随机生成，amqp开头），非持久化
    - 连接关闭时，队列将被删除，因为它被声明为独占（Exclusive：true）

- 绑定交换机  QueueBind需要设置key
- 接受独占队列的消息（消息自动确认）

```
* 如果没有队列绑定到交换机，消息不会被转发到任何队列，意味着消息会丢失
* 根据不同的路由键，消息不同的消费者消费
```